<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Free Online Hangman Game ‚Äì Play with Multiple Categories and Difficulty Levels</title>
    <meta name="description" content="Play the enhanced Hangman word game online for free! Features multiple categories including animals, places, movies, and more. Choose from easy, medium, or hard difficulty levels. Perfect for vocabulary building and entertainment.">
    <meta name="keywords" content="hangman game, word game, vocabulary game, free online game, word puzzle, educational game, browser game, animals game, places game, movies game, difficulty levels">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://www.freeplayfulgames.com/hangman-game.html">
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="Free Online Hangman Game ‚Äì Multiple Categories and Difficulty Levels">
    <meta property="og:description" content="Play the enhanced Hangman game with various categories (animals, places, movies) and difficulty levels. Perfect for all ages and skill levels. Test your vocabulary with this fun, free word puzzle game!">
    <meta property="og:type" content="game">
    <meta property="og:url" content="https://www.freeplayfulgames.com/hangman-game.html">
    <meta property="og:image" content="https://www.freeplayfulgames.com/hangman-game.png">
    <meta property="og:site_name" content="Free Playful Games">
    
    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Free Online Hangman Game ‚Äì Multiple Categories">
    <meta name="twitter:description" content="Play Hangman with animals, places, movies, and more! Choose your difficulty level and expand your vocabulary while having fun.">
    <meta name="twitter:image" content="https://www.freeplayfulgames.com/hangman-game.png">
    
    <!-- Schema.org JSON-LD -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "VideoGame",
      "name": "Hangman Fun Quest",
      "description": "Play the classic Hangman word game online for free! Guess the hidden word one letter at a time before the man hangs. Test your vocabulary and have fun solving word puzzles.",
      "url": "https://www.freeplayfulgames.com/hangman-game.html",
      "image": "https://www.freeplayfulgames.com/hangman-game.png",
      "genre": "Word Game",
      "playMode": "SinglePlayer",
      "gamePlatform": "Web Browser",
      "applicationCategory": "Game",
      "operatingSystem": "Any",
      "inLanguage": "en",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD",
        "availability": "https://schema.org/InStock"
      },
      "aggregateRating": {
        "@type": "AggregateRating",
        "ratingValue": "4.8",
        "ratingCount": "156"
      }
    }
    </script>

    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        /* CSS RESET */
        *, *::before, *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        :root {
            --mc-orange: #FF6F00;
            --mc-blue: #005A9C;
            --mc-yellow: #f1c40f;
            --font-family-main: 'Fredoka', sans-serif;
            --bg-gradient-start: #2c3e50;
            --bg-gradient-end: #4ca1af;
            --text-light: #f0e68c;
            --white: #FFFFFF;
            --black: #000000;
        }        /* Firework Animation */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
            z-index: 1000;
            pointer-events: none;
        }
        
        .modal-overlay.show {
            opacity: 1;
        }
        
        .modal {
            background: linear-gradient(135deg, #2ecc71, #27ae60);
            padding: 2rem;
            border-radius: 1rem;
            transform: scale(0.7);
            transition: transform 0.3s ease-in-out;
            color: white;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .modal-overlay.show .modal {
            transform: scale(1);
        }
        
        .firework,
        .firework::before,
        .firework::after {
            --initialSize: 0.5vmin;
            --finalSize: 45vmin;
            --particleSize: 0.2vmin;
            --color1: yellow;
            --color2: khaki;
            --color3: white;
            --color4: lime;
            --color5: gold;
            --color6: mediumseagreen;
            --y: -30vmin;
            --x: -50%;
            --initialY: 60vmin;
            content: "";
            animation: firework 2s infinite;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, var(--y));
            width: var(--initialSize);
            aspect-ratio: 1;
            background: 
                radial-gradient(circle, var(--color1) var(--particleSize), #0000 0) 0% 0%,
                radial-gradient(circle, var(--color2) var(--particleSize), #0000 0) 100% 0%,
                radial-gradient(circle, var(--color3) var(--particleSize), #0000 0) 100% 100%,
                radial-gradient(circle, var(--color4) var(--particleSize), #0000 0) 0% 100%,
                radial-gradient(circle, var(--color5) var(--particleSize), #0000 0) 50% 0%,
                radial-gradient(circle, var(--color6) var(--particleSize), #0000 0) 50% 100%,
                radial-gradient(circle, var(--color1) var(--particleSize), #0000 0) 0% 50%,
                radial-gradient(circle, var(--color2) var(--particleSize), #0000 0) 100% 50%
                ;
            background-size: var(--initialSize) var(--initialSize);
            background-repeat: no-repeat;
            z-index: 999;
        }

        @keyframes firework {
            0% { transform: translate(var(--x), var(--initialY)); width: var(--initialSize); opacity: 1; }
            50% { width: 0.5vmin; opacity: 1; }
            100% { width: var(--finalSize); opacity: 0; }
        }

        body {
            font-family: var(--font-family-main);
            background-image: linear-gradient(to bottom, var(--bg-gradient-start), var(--bg-gradient-end));
            color: var(--white);
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            padding: 15px;
            box-sizing: border-box;
            overflow-x: hidden;
            position: relative;
            z-index: 1;
        }

        h1 {
            font-size: 2rem;
            font-weight: 600;
            color: var(--mc-yellow);
            margin-bottom: 15px;
            text-align: center;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }        
        .game-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            
            width: 100%;
            max-width: 950px;
            margin: 0 auto; 
        }

        .game-info-wrapper {
            display: flex;
            flex-direction: row;
            justify-content: space-around;
            align-items: flex-start;
            width: 100%;
            gap: 20px;
            margin-bottom: 15px;
        }

        .hangman-canvas-container {
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            min-width: 300px;
           
            padding: 10px;
        }

        #hangmanCanvas {
            border-radius: 8px;
            max-width: 100%;
            min-height: 300px;
        }

        .word-status-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
        }

        .word-display {            font-size: 2rem;
            letter-spacing: 0.5em;
            color: #36ff56;
            min-height: 40px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .guesses-remaining, .incorrect-guesses-display {
            font-size: 1.1rem;
            color: var(--text-light);
            font-weight: 500;
        }        .incorrect-letters {
            color: var(--mc-orange);
            font-weight: bold;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
        }
        .keyboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(35px, 1fr));
            gap: 5px;
            width: 100%;
            max-width: 600px;
            margin-top: 20px;
            padding: 10px;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        .keyboard button {
            padding: 7px 10px;
            font-size: 1.5rem;
            font-weight: 500;
            border: none;
            background-color: var(--mc-blue);
            color: var(--white);
            border-radius: 14px;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
            box-shadow: 0 2.1px 4.2px rgba(0,0,0,0.2);
        }

        .keyboard button:hover:not(:disabled) {
            background-color: var(--mc-orange);
            transform: translateY(-1px);
            box-shadow: 0 3px 6px rgba(0,0,0,0.3);
        }

        .keyboard button:active:not(:disabled) {
            transform: translateY(1px);
            box-shadow: 0 1px 2px rgba(0,0,0,0.2);
        }

        .keyboard button:disabled {
            background-color: rgba(255, 255, 255, 0.2);
            color: rgba(255, 255, 255, 0.4);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }        .message-popup {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
        }

        .message-popup.show {
            display: flex;
            opacity: 1;
        }

        .message-popup-content {
            background: linear-gradient(135deg, #2ecc71, #27ae60);
            padding: 2rem 3rem;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            text-align: center;
            transform: scale(0.7);
            transition: transform 0.3s ease-in-out;
        }

        .message-popup.show .message-popup-content {
            transform: scale(1);
        }

        .message-popup-content h2 {
            color: white;
            font-size: 2rem;
            margin-bottom: 15px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .message-popup-content p {
            color: white;
            font-size: 1.2rem;
            margin-bottom: 20px;
        }

        #playAgainButton {
            padding: 8.8px 17.6px;
            font-size: 0.99rem;
            font-weight: 600;
            background-color: var(--mc-orange);
            color: white;
            border: none;
            border-radius: 19.25px;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 2.2px 4.4px rgba(0,0,0,0.2);
            min-width: 115.5px;
        }

        #playAgainButton:hover {
            background-color: #e65c00;
            transform: translateY(-1px);
            box-shadow: 0 3px 6px rgba(0,0,0,0.3);
        }

        a.home-button {
            display: inline-block;
            margin-top: 10px;
            padding: 7px 14px;
            background-color: #e74c3c;
            color: white;
            text-decoration: none;
            border-radius: 14px;
            font-size: 0.7rem;
            font-weight: 500;
            box-shadow: 0 2.1px #c0392b;
            position: relative;
            z-index: 1000;
            transition: all 0.2s ease;
        }

        a.home-button:hover {
            background-color: #c0392b;
            transform: translateY(-1px);
        }

        a.home-button:active {
            transform: translateY(1px);
            box-shadow: 0 1px #c0392b;
        }        button.new-word-button {
            display: inline-block;
            margin-top: 10px;
            padding: 7px 14px;
            transition: background-color 0.2s;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
            background-color: #2ecc71;
            color: white;
            text-decoration: none;
            border-radius: 14px;
            font-size: 0.7rem;
            font-weight: 500;
            position: relative;
            z-index: 1000;
            transition: all 0.2s ease;
            border: none;
            cursor: pointer;
            font-weight: 600;
        }

        button.new-word-button:hover {
            background-color: #2ecc71;
            transform: translateY(-1px);
        }

        button.new-word-button:active {
            transform: translateY(1px);
            box-shadow: 0 1px #c0392b;
        }

        .menu-button {
            display: block;
            margin-top: 15px;
            padding: 8.8px 17.6px;
            font-size: 0.99rem;
            font-weight: 600;
            background-color: var(--mc-blue);
            color: white;
            border: none;
            border-radius: 19.25px;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 2.2px 4.4px rgba(0,0,0,0.2);
            min-width: 115.5px;
            text-decoration: none;
            text-align: center;
        }

        .menu-button:hover {
            background-color: #004a80;
            transform: translateY(-1px);
            box-shadow: 0 3px 6px rgba(0,0,0,0.3);
        }

        a.home-button {
            display: inline-block;
            margin-top: 30px; /* 30% smaller */
            padding: 7px 14px; /* 30% smaller */
            background-color: #e74c3c;
            color: white;
            text-decoration: none;
            border-radius: 14px; /* 30% smaller */
            font-size: 0.7rem; /* 30% smaller */
            font-weight: 500;
            box-shadow: 0 2.1px #c0392b; /* 30% smaller */
        }
        a.home-button:active { transform: translateY(1px); box-shadow: 0 2px #c0392b; }        .game-settings {
            display: flex;
            gap: 20px;
            margin: 0 auto 20px;
            justify-content: center;
            flex-wrap: wrap;
            max-width: 900px;
            padding: 15px;
            border-radius: 15px;
        }

        .setting-group {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
        }

        .setting-group label {            color: #f0e68c;
            font-size: 0.9rem;
            font-weight: normal;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }        .setting-group select {
            padding: 8.8px 17.6px;
            font-size: 0.99rem;
            font-weight: normal;
            background-color: var(--mc-blue);
            color: white;
            border: none;
            border-radius: 19.25px;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 2.2px 4.4px rgba(0,0,0,0.2);
            min-width: 150px;
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            background-image: url("data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%23FFFFFF%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%000-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E");
            background-repeat: no-repeat;
            background-position: right 12px top 50%;
            background-size: 12px auto;
            padding-right: 30px;
        }

        .setting-group select:hover {
            background-color: #004a80;
            transform: translateY(-1px);
            box-shadow: 0 3px 6px rgba(0,0,0,0.3);
        }

        .setting-group select:focus {
            outline: none;
            background-color: #004a80;
            box-shadow: 0 0 0 3px rgba(0, 119, 204, 0.3);
        }

        /* Tooltip styles */
        .tooltip-wrapper {
            display: inline-block;
            position: relative;
            margin-left: 8px;
        }

        /* Interactive Hint Icon */
        .hint-info-icon {
            cursor: pointer;
            font-size: 1.2em;
            vertical-align: middle;
            transition: all 0.3s ease;
            user-select: none;
        }

        .hint-info-icon:hover {
            transform: scale(1.2);
            filter: brightness(1.2);
        }

        .hint-info-icon:active {
            transform: scale(0.9);
        }

        .hint-info-icon[data-hints="0"] {
            cursor: default;
            opacity: 0.5;
        }

        .hint-info-icon[data-hints="0"]:hover {
            transform: none;
            filter: none;
        }

        /* Existing hint animation can be reused or adapted */
        @keyframes hintUsed { /* This was for the group, can be repurposed or a new one made */
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.2); opacity: 0.5; }
            100% { transform: scale(0); opacity: 0; }
        }

        .hint-icon-container {
            display: inline-block; /* Allows bulbs to sit next to each other */
            vertical-align: middle;
        }

        .hint-bulb {
            display: inline-block;
            cursor: pointer;
            font-size: 1.2em; /* Or your preferred size */
            transition: transform 0.2s ease, opacity 0.2s ease;
            margin: 0 2px; /* Optional spacing between bulbs */
            user-select: none;
        }

        .hint-bulb:hover {
            transform: scale(1.2);
        }

        .hint-bulb.used {
            animation: hintUsed 0.3s ease-out forwards;
            pointer-events: none; /* Prevent further interaction during/after animation */
        }

        /* Responsive adjustments */
        @media (max-width: 600px) {
            h1 {
                font-size: 1.6rem;
            }
            .game-info-wrapper {
                flex-direction: column;
                align-items: center;
            }
            .hangman-canvas-container {
                width: 100%;
                max-width: 250px;
            }
            .word-display {
                font-size: 1.5rem;
                letter-spacing: 0.3em;
            }
            .keyboard button {
                font-size: 0.63rem;
            }
            .keyboard {
                grid-template-columns: repeat(auto-fit, minmax(30px, 1fr));
            }
        }

        @media (max-width: 375px) {
            .keyboard button {
                font-size: 0.8rem;
            }
        } 
    </style>
</head>
<body>
    <h1>Hangman - The Classic Word Guessing Game</h1>

    <h2 class="game-desc" style="max-width: 850px; margin: 0 auto 18px auto; color: #f0e68c; font-size: .9rem; text-align: center; font-weight: normal;">
        Enjoy the classic Hangman word game online for free‚Äîno downloads or sign-up required. Guess the hidden word one letter at a time before the man hangs, and have fun testing your vocabulary with this timeless word puzzle!
    </h2>

    <div class="game-settings">
        <div class="setting-group">
            <label for="categorySelect">Category:</label>            <select id="categorySelect">
                <option value="all">All Categories</option>
            </select>
        </div>
        <div class="setting-group">
            <label for="difficultySelect">Difficulty:</label>
            <select id="difficultySelect">
                <option value="easy">Easy</option>
                <option value="medium" selected>Medium</option>
                <option value="hard">Hard</option>
            </select>
        </div>
    </div>

    <div class="game-container">
        
            <div class="hangman-canvas-container">
                <canvas id="hangmanCanvas" width="180" height="250"></canvas>
            </div>
            <div class="word-status-container">
                <!-- In your .game-info-wrapper -->
                <p class="guesses-remaining">
                    Guesses Left: <span id="guessesLeft">6</span>
                    <span class="tooltip-wrapper">
                        <!-- This span will now be a CONTAINER for individual bulb icons -->
                        <span class="hint-icon-container"></span>
                        
                    </span>
                </p>
                <div class="word-display" id="wordDisplay"></div>
                <p class="incorrect-guesses-display">Incorrect Guesses: <span id="incorrectLetters" class="incorrect-letters"></span></p>
            </div>
        
        <div class="keyboard" id="keyboard"></div>
    </div>

    <div class="message-popup" id="messagePopup">
        <div class="message-popup-content">
            <h2 id="popupTitle"></h2>
            <p id="popupMessage"></p>            <button id="playAgainButton">Play Again</button>
            
        </div>
    </div>    <div>

        <button class="new-word-button" id="newWordBtn">New Word</button>
        <a href="index.html" class="home-button">üè† Back to Main Menu</a>
    </div><!-- Load word list first -->    <script src="js/hangman-game.js"></script>
    <script>
        // --- CONFIGURATION ---
        // Wait for hangmanData to be available
        document.addEventListener('DOMContentLoaded', function() {
            if (!window.hangmanData || !window.hangmanData.categories) {
                console.error('hangmanData is not loaded properly');
                return;
            }
            
            // Populate category dropdown
            const categorySelect = document.getElementById('categorySelect');
            categorySelect.innerHTML = '<option value="all">All Categories</option>';
            // Add common category first and select it by default
            const commonOption = document.createElement('option');
            commonOption.value = 'everyday';
            commonOption.textContent = 'Everyday';
            commonOption.selected = true;
            categorySelect.appendChild(commonOption);
            
            // Get categories and sort them alphabetically
            const categories = Object.keys(window.hangmanData.categories).sort();
            
            // Add each category as an option
            categories.forEach(category => {
                const option = document.createElement('option');
                option.value = category;
                option.textContent = category.charAt(0).toUpperCase() + category.slice(1).toLowerCase();
                categorySelect.appendChild(option);
            });
        });
        let WORD_LIST = []; // Will be set from hangman-game.js
        const MAX_INCORRECT_GUESSES = 8; // Corresponds to hangman parts (including toes)
        let currentCategory = 'everyday'; // Default to everyday words
        let currentDifficulty = 'medium'; // Default difficulty

        // --- DOM ELEMENTS ---
        const wordDisplayEl = document.getElementById('wordDisplay');
        const guessesLeftEl = document.getElementById('guessesLeft');
        const incorrectLettersEl = document.getElementById('incorrectLetters');
        const keyboardEl = document.getElementById('keyboard');
        const canvas = document.getElementById('hangmanCanvas');
        const ctx = canvas.getContext('2d');
        const messagePopupEl = document.getElementById('messagePopup');
        const popupTitleEl = document.getElementById('popupTitle');
        const popupMessageEl = document.getElementById('popupMessage');
        const playAgainButton = document.getElementById('playAgainButton');
        const categorySelect = document.getElementById('categorySelect');
        const difficultySelect = document.getElementById('difficultySelect');

        // --- GAME STATE VARIABLES ---
        let currentWord = '';
        let revealedWord = [];
        let guessedLetters = [];        let incorrectGuesses = 0;
        let hintsRemaining = 1; // Default to easy mode
        let maxHints = 1; // Default to easy mode

        // Function to set hints based on difficulty
        function setHintsForDifficulty(difficulty) {
            switch(difficulty) {
                case 'easy':
                    maxHints = 1;
                    break;
                case 'medium':
                case 'hard':
                    maxHints = 2;
                    break;
                default:
                    maxHints = 1;
            }
            hintsRemaining = maxHints;
        }

        /**
         * Reveals one hidden letter in the current word.
         * @param {string} word - The original word (e.g., "FROG")
         * @param {string[]} revealed - Array representing revealed letters (e.g., ["F", "_", "_", "G"])
         * @returns {string[]} Updated revealed array with one more letter shown
         */
        function giveHint(word, revealed) {
            // Find all indices of unrevealed letters
            const hiddenIndices = [];
            for (let i = 0; i < word.length; i++) {
                if (revealed[i] === "_" || revealed[i] === "") {
                    hiddenIndices.push(i);
                }
            }

            // If there are no hidden letters left, return as is
            if (hiddenIndices.length === 0) return revealed;

            // Pick one random hidden index to reveal
            const randomIndex = hiddenIndices[Math.floor(Math.random() * hiddenIndices.length)];
            revealed[randomIndex] = word[randomIndex].toUpperCase();

            return revealed;
        }
 

        const hintIconContainer = document.querySelector('.hint-icon-container');
        const hintsLeftTextEl = document.getElementById('hintsLeftText'); // For the text display

        function updateHintsDisplay() {
            if (!hintIconContainer) return;

            hintIconContainer.innerHTML = ''; // Clear existing bulbs

            if (hintsRemaining > 0) {
                hintIconContainer.style.display = 'inline-block'; // Show container
                for (let i = 0; i < hintsRemaining; i++) {
                    const bulbSpan = document.createElement('span');
                    bulbSpan.classList.add('hint-bulb');
                    bulbSpan.textContent = 'üí°';
                    bulbSpan.addEventListener('click', handleHintClick); // Add click listener to each bulb
                    hintIconContainer.appendChild(bulbSpan);
                }
            } else {
                hintIconContainer.style.display = 'none'; // Hide container if no hints
            }

            // Update the optional text display
            if (hintsLeftTextEl) {
                if (hintsRemaining > 0) {
                    hintsLeftTextEl.textContent = `(${hintsRemaining} hint${hintsRemaining !== 1 ? 's' : ''} left)`;
                } else {
                    hintsLeftTextEl.textContent = '(No hints left)';
                }
            }
        }


        function handleHintClick(event) {
            const clickedBulb = event.target; // The specific üí° span that was clicked

            if (hintsRemaining <= 0 || !currentWord || clickedBulb.classList.contains('used')) {
                return; // No hints left, game not started, or bulb already used
            }

            clickedBulb.classList.add('used'); // Add class to trigger animation

            // Apply the actual hint logic
            // This part is similar to your old handleHint function
            revealedWord = giveHint(currentWord, revealedWord);
            
            for (let i = 0; i < currentWord.length; i++) {
                if (currentWord[i] === revealedWord[i]) {
                    if (!guessedLetters.includes(currentWord[i])) {
                        guessedLetters.push(currentWord[i]);
                    }
                }
            }

            hintsRemaining--; // Decrement hints AFTER processing

            // Update game displays
            updateWordDisplay();
            updateKeyboard();
            checkWinCondition();

            // After animation, remove the bulb from DOM (optional, CSS can just hide it)
            // And then refresh the hint display to show correct count / text
            setTimeout(() => {
                // If you want to physically remove it:
                // if (clickedBulb.parentNode) {
                //     clickedBulb.parentNode.removeChild(clickedBulb);
                // }
                // Then call updateHintsDisplay() again to redraw with one less,
                // OR just update the text count if you are not removing.
                // For simplicity with the current animation, let's let updateHintsDisplay handle redraw
                updateHintsDisplay(); // This will redraw with one less bulb and update text
            }, 300); // Match animation duration

            event.stopPropagation();
        }


        // In your handleHint function, make sure the animation is triggered correctly.
        function handleHint(event) {
            if (hintsRemaining <= 0 || !currentWord) return;
            
            const hintIcon = document.querySelector('.hint-info-icon');
            if (hintIcon && hintsRemaining > 0) { // Check hintsRemaining > 0 before adding class
                hintIcon.classList.add('hint-used'); // Trigger animation
            }

            // Update revealed word with hint
            revealedWord = giveHint(currentWord, revealedWord);
            
            // Add the newly revealed letter to guessed letters
            for (let i = 0; i < currentWord.length; i++) {
                if (currentWord[i] === revealedWord[i]) {
                    if (!guessedLetters.includes(currentWord[i])) {
                        guessedLetters.push(currentWord[i]);
                    }
                }
            }

            // Update displays
            hintsRemaining--;
            updateWordDisplay();
            updateKeyboard();
            updateHintsDisplay(); // This will now update bulbs and visibility
            
            // Check if won
            checkWinCondition();

            // Prevent tooltip from closing immediately (if you had one)
            if (event) {
                event.stopPropagation();
            }
        }

        function initializeGame() {
            const difficulty = document.getElementById('difficultySelect').value;
            setHintsForDifficulty(difficulty); // This sets hintsRemaining

            currentWord = selectRandomWord();
            revealedWord = Array(currentWord.length).fill('_');
            guessedLetters = [];
            incorrectGuesses = 0;
            
            updateWordDisplay();
            updateGuessesLeftDisplay();
            updateIncorrectLettersDisplay();
            resetKeyboard();
            resetCanvas();
            
            updateHintsDisplay(); // CRITICAL: Call this to draw the initial bulbs
        }

        // Add click handler for tooltip        
        document.addEventListener('DOMContentLoaded', () => {            // Initialize canvas
            gameCanvas = document.getElementById('hangmanCanvas');
            if (gameCanvas) {
                gameCanvas.width = 200;
                gameCanvas.height = 250;
                gameCtx = gameCanvas.getContext('2d');
                resetCanvas();
            }            // Add hint icon click handler
            const hintIcon = document.querySelector('.hint-info-icon');
            if (hintIcon) {
                hintIcon.addEventListener('click', (e) => {
                    if (hintsRemaining > 0) {
                        handleHint(e);
                    }
                });
            }

            // Initialize game
            initializeGame();
        });

        // --- GAME LOGIC ---            
        function selectRandomWord() {
            // Check if hangmanData is loaded
            if (typeof hangmanData === 'undefined') {
                console.error('Word list not loaded properly');
                return "FALLBACK"; // Fallback word in case of error
            }

            let wordPool;
            
            // First, get words for the selected category
            if (currentCategory === 'all') {
                wordPool = [...hangmanData.wordList]; // Create a copy of the full word list
            } else if (currentCategory in hangmanData.categories) {
                wordPool = [...hangmanData.categories[currentCategory]]; // Create a copy of the category words
            } else {
                wordPool = [...hangmanData.wordList]; // Fallback to full list
            }

            // Then, filter by difficulty
            if (currentDifficulty in hangmanData.difficulty) {
                const difficultyWords = new Set(hangmanData.difficulty[currentDifficulty]);
                wordPool = wordPool.filter(word => difficultyWords.has(word));
            }

            // If no words match both category and difficulty, try just the category
            if (wordPool.length === 0 && currentCategory !== 'all' && currentCategory in hangmanData.categories) {
                wordPool = [...hangmanData.categories[currentCategory]];
            }

            // If still empty, fallback to full word list
            if (wordPool.length === 0) {
                wordPool = [...hangmanData.wordList];
            }

            // Remove the current word from the pool if it exists
            if (currentWord) {
                wordPool = wordPool.filter(word => word !== currentWord);
            }

            // If we've used all words in the pool, use the full pool
            if (wordPool.length === 0) {
                if (currentCategory === 'all') {
                    wordPool = [...hangmanData.wordList];
                } else if (currentCategory in hangmanData.categories) {
                    wordPool = [...hangmanData.categories[currentCategory]];
                } else {
                    wordPool = [...hangmanData.wordList];
                }
            }

            return wordPool[Math.floor(Math.random() * wordPool.length)];
        }

        function updateWordDisplay() {
            wordDisplayEl.textContent = revealedWord.join(' ');
        }

        function updateGuessesLeftDisplay() {
            guessesLeftEl.textContent = MAX_INCORRECT_GUESSES - incorrectGuesses;
        }

        function updateIncorrectLettersDisplay() {
            const incorrect = guessedLetters.filter(letter => !currentWord.includes(letter));
            incorrectLettersEl.textContent = incorrect.join(', ');
        }

        function createKeyboard() {
            const letters = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
            letters.split('').forEach(letter => {
                const button = document.createElement('button');
                button.textContent = letter;
                button.addEventListener('click', () => handleGuess(letter));
                keyboardEl.appendChild(button);
            });
        }
        
        function resetKeyboard() {
            const buttons = keyboardEl.getElementsByTagName('button');
            for (let button of buttons) {
                button.disabled = false;
            }
        }

        function handleGuess(letter) {
            if (guessedLetters.includes(letter) || incorrectGuesses >= MAX_INCORRECT_GUESSES || revealedWord.join('') === currentWord) {
                return; // Already guessed or game over
            }

            guessedLetters.push(letter);
            disableKeyboardButton(letter);

            if (currentWord.includes(letter)) {
                // Correct guess
                for (let i = 0; i < currentWord.length; i++) {
                    if (currentWord[i] === letter) {
                        revealedWord[i] = letter;
                    }
                }
                updateWordDisplay();
                checkWinCondition();
            } else {
                // Incorrect guess
                incorrectGuesses++;
                updateGuessesLeftDisplay();
                updateIncorrectLettersDisplay();
                drawHangman();
                checkLossCondition();
            }
        }
        
        function disableKeyboardButton(letter) {
            const buttons = keyboardEl.getElementsByTagName('button');
            for (let button of buttons) {
                if (button.textContent === letter) {
                    button.disabled = true;
                    break;
                }
            }
        }        function checkWinCondition() {
            if (revealedWord.join('') === currentWord) {
                // Show fireworks celebration
                showFireworks(3);
                // Create and show modal
                const modalOverlay = document.createElement('div');
                modalOverlay.className = 'modal-overlay';
                const modal = document.createElement('div');
                modal.className = 'modal';
                modal.innerHTML = '<h2>Congratulations! üéâ</h2>';
                modalOverlay.appendChild(modal);
                document.body.appendChild(modalOverlay);
                
                // Force reflow for animation
                void modalOverlay.offsetWidth;
                modalOverlay.classList.add('show');
                
                // Remove modal after 2 seconds
                setTimeout(() => {
                    modalOverlay.classList.remove('show');
                    setTimeout(() => modalOverlay.remove(), 300); // Wait for fade out
                }, 2000);

                // Show popup with slight delay
                setTimeout(() => {
                    showPopup("You Win! üéâ", `The word was: ${currentWord}`);
                }, 2500);
            }
        }

        function checkLossCondition() {
            if (incorrectGuesses >= MAX_INCORRECT_GUESSES) {
                showPopup("Game Over üòï", `The word was: ${currentWord}`);
            }
        }        function showPopup(title, message) {
            popupTitleEl.textContent = title;
            popupMessageEl.textContent = message;
            messagePopupEl.classList.add('show');
        }

        function showMessage(message, title) {
            popupTitleEl.textContent = title;
            popupMessageEl.textContent = message;
            messagePopupEl.classList.add('show');
            setTimeout(() => {
                messagePopupEl.classList.remove('show');
            }, 2000);
        }        // Game canvas reference
        let gameCanvas = null;
        let gameCtx = null;

        function resetCanvas() {
            if (!gameCanvas) {
                gameCanvas = document.getElementById('hangmanCanvas');
                gameCtx = gameCanvas.getContext('2d');
            }
            gameCtx.clearRect(0, 0, gameCanvas.width, gameCanvas.height);
            // Draw gallows
            Draw('gallows');
        }

        // --- CANVAS DRAWING ---        
        const draws = [
            'gallows',
            'head',
            'body',
            'rightHarm',
            'leftHarm',
            'rightLeg',
            'leftLeg',
            'rightFoot',
            'leftFoot',
            'rightToe',
            'leftToe',
        ];        
        
        function Draw(part) {
            if (!gameCtx) return;
            
            switch (part) {
                case 'gallows':                    gameCtx.strokeStyle = '#FF6F00';
                    gameCtx.lineWidth = 10;
                    gameCtx.beginPath();
                    gameCtx.moveTo(175, 225);
                    gameCtx.lineTo(5, 225);
                    gameCtx.moveTo(40, 225);
                    gameCtx.lineTo(25, 5);
                    gameCtx.lineTo(100, 5);
                    gameCtx.lineTo(100, 25);
                    gameCtx.stroke();
                    break;

                case 'head':
                    ctx.lineWidth = 5;
                    ctx.beginPath();
                    ctx.arc(100, 50, 25, 0, Math.PI * 2, true);
                    ctx.closePath();
                    ctx.stroke();
                    break;

                case 'body':
                    ctx.beginPath();
                    ctx.moveTo(100, 75);
                    ctx.lineTo(100, 140);
                    ctx.stroke();
                    break;

                case 'rightHarm':
                    ctx.beginPath();
                    ctx.moveTo(100, 85);
                    ctx.lineTo(60, 100);
                    ctx.stroke();
                    break;

                case 'leftHarm':
                    ctx.beginPath();
                    ctx.moveTo(100, 85);
                    ctx.lineTo(140, 100);
                    ctx.stroke();
                    break;

                case 'rightLeg':
                    ctx.beginPath();
                    ctx.moveTo(100, 140);
                    ctx.lineTo(80, 190);
                    ctx.stroke();
                    break;

                case 'rightFoot':
                    ctx.beginPath();
                    ctx.moveTo(82, 190);
                    ctx.lineTo(70, 185);
                    ctx.stroke();
                    break;

                case 'leftLeg':
                    ctx.beginPath();
                    ctx.moveTo(100, 140);
                    ctx.lineTo(125, 190);
                    ctx.stroke();
                    break;

                case 'leftFoot':
                    ctx.beginPath();
                    ctx.moveTo(122, 190);
                    ctx.lineTo(135, 185);
                    ctx.stroke();
                    break;

                case 'rightToe':
                    ctx.beginPath();
                    ctx.moveTo(70, 185);
                    ctx.lineTo(65, 195);
                    ctx.stroke();
                    break;

                case 'leftToe':
                    ctx.beginPath();
                    ctx.moveTo(135, 185);
                    ctx.lineTo(140, 195);
                    ctx.stroke();
                    break;
            }
        }

        function drawHangman() {
            if (incorrectGuesses > 0 && incorrectGuesses <= draws.length) {
                Draw(draws[incorrectGuesses - 1]);
            }
        }        // Firework celebration function
        function showFireworks(times = 3) {
            for (let i = 0; i < times; i++) {
                const firework = document.createElement('div');
                firework.className = 'firework';
                firework.style.animationDelay = `${i * 0.2}s`;
                document.body.appendChild(firework);
                setTimeout(() => {
                    if (firework.parentNode) firework.parentNode.removeChild(firework);
                }, 2000);
            }
        }

        // --- INITIALIZE ---
        createKeyboard();
        initializeGame();

        // --- EVENT LISTENERS ---        
        playAgainButton.addEventListener('click', initializeGame);
        categorySelect.addEventListener('change', function(e) {
            currentCategory = e.target.value;
            initializeGame();
        });
        
        difficultySelect.addEventListener('change', function(e) {
            currentDifficulty = e.target.value;
            initializeGame();
        });
        
    </script>
</body>
</html>