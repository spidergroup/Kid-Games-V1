<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">    <title>Free Three (4 & 6) Card Monte - Can You Find the Card?</title>
    <meta name="description" content="Try the ultimate memory challenge! Play free 3, 4, or 6 card monte games online. Watch closely, track the shuffle, and find the hidden object!">
    <meta name="keywords" content="three card monte, card game, kids game, focus game, brain game, concentration game, educational game, fun, interactive, browser game, free game">
    <meta name="author" content="Kid Games">
    <meta property="og:title" content="Free Card Monte Memory Challenge ‚Äì Find the Hidden Card Online">
    <meta property="og:description" content="Boost your focus with this free online memory challenge! Track 3, 4, or 6 shuffling cards and find the hidden pet, fruit, letter, or number.">
    <meta property="og:image" content="https://www.freeplayfulgames.com/three-card-monte.png">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://www.freeplayfulgames.com/three-card-monte.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Free Card Monte Memory Challenge ‚Äì Online Find-the-Card Game">
    <meta name="twitter:description" content="Play a fast, fun memory challenge! Watch cards shuffle and find the hidden object. Try 3, 4, or 6 card versions‚Äîfree and browser-based.">
    <meta name="twitter:image" content="https://www.freeplayfulgames.com/three-card-monte.png">
    <link rel="canonical" href="https://www.freeplayfulgames.com/three-card-monte.html">
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;500;600&display=swap" rel="stylesheet">
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-J0PVJ95F71"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-J0PVJ95F71');    </script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "VideoGame",
      "name": "Free Card Monte Memory Challenge",
      "description": "Play a free online card monte memory challenge. Choose 3, 4, or 6 cards, track the shuffle, and find the hidden pet, fruit, letter, or number. A fun and simple memory test.",
      "applicationCategory": "GameApplication",
      "operatingSystem": "All",
      "browserRequirements": "Requires JavaScript and a modern browser",
      "playMode": "SinglePlayer",
      "url": "https://www.freeplayfulgames.com/three-card-monte.html",
      "image": "https://www.freeplayfulgames.com/three-card-monte.png",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD"
      }
    }
    </script>
    <style>
        :root {
            --mc-orange: #FF6F00;
            --mc-blue: #005A9C;
            --mc-yellow: #f1c40f; /* Game title & active borders */
            --font-family-main: 'Fredoka', sans-serif;
            --bg-gradient-start: #2c3e50;
            --bg-gradient-end: #4ca1af;
            --text-light: #f0e68c;
            --white: #FFFFFF;
            --black: #000000;
            --card-purple: #8A2BE2;
            --card-blue: #007BFF;
        }

        body {
            font-family: var(--font-family-main);
            background-image: linear-gradient(to bottom, var(--bg-gradient-start), var(--bg-gradient-end));
            color: var(--white);
            display: flex;
            flex-direction: column;
            align-items: center;
            
            min-height: 100vh;
            padding: 15px;
            box-sizing: border-box;
            overflow-x: hidden;
            position: relative;
            z-index: 1;
        }

        .game-title-main {
            font-size: 1.6rem;
            font-weight: 600;
            color: var(--mc-yellow);
            margin-bottom: 15px;
            text-align: center;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }

        .menus-wrapper {
            display: flex;
            flex-direction: column;
            gap: 10px;
            width: 100%;
            max-width: 440px; /* Adjusted for simpler menu */
            margin-bottom: 15px;
            position: relative;
            z-index: 20;
        }

        .menu-container {
            padding: 10px 15px;
            border-radius: 12px;
            background-color: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        .menu-title {
            font-size: 1.1rem;
            font-weight: 600;
            text-align: center;
            margin-bottom: 10px;
            color: var(--text-light);
        }

        .level-menu {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 8px;
        }

        .menu-button {
            padding: 5.6px 10.5px; /* 30% smaller */
            border-radius: 14px;
            border: 2px solid transparent;
            font-size: 0.63rem; /* 30% smaller */
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
            background-color: var(--mc-orange);
            color: var(--white);
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        .menu-button:hover:not(.active) {
            background-color: #e65c00;
            transform: translateY(-2px);
        }
        .menu-button.active {
            font-weight: 600;
            transform: scale(1.05);
            background-color: var(--mc-blue);
            border-color: var(--mc-yellow);
            color: var(--white);
        }

        #game-interaction-area {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
            max-width: 600px;
            margin: 0 auto 10px auto;
            position: relative;
            z-index: 20;
        }

        #action-button-container {
            text-align: center;
            margin-bottom: 8px;
        }

        #message-area {
            font-size: 1.1rem;
            font-weight: 500;
            color: var(--text-light);
            height: 25px;
            text-align: center;
            margin-bottom: 10px;
        }
          #actionButton {
            padding: 8.8px 17.6px; /* 10% larger */
            font-size: 0.99rem; /* 10% larger */
            font-weight: 600;
            border-radius: 19.25px; /* 10% larger */
            background-color: #2ecc71;
            color: white;
            border: none;
            cursor: pointer;
            transition: background-color 0.2s;
            box-shadow: 0 2.2px 4.4px rgba(0,0,0,0.2); /* 10% larger */
            min-width: 115.5px; /* 10% larger */
        }
        #actionButton:hover:not(:disabled) { background-color: #27ae60; }
        #actionButton:disabled { background-color: #9ca3af; cursor: not-allowed; opacity: 0.7; }        .game-board-shell {
            position: relative;
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px;
            width: 280px;
            height: 280px;
            margin: 15px auto;
            z-index: 10;
            transform-style: preserve-3d;
            perspective: 1000px;
        }
        /* Specific styles for 6-card layout */
        .game-board-shell.six-cards {
            grid-template-columns: repeat(3, 1fr);
            width: 280px;
            height: 190px;
            gap: 6px;
        }
        .game-board-shell.six-cards .card-shell {
            width: 110px;
            height: 110px;
        }

        /* Specific styles for 3-card layout */
        .game-board-shell.three-cards {
            display: flex;
            flex-direction: row;
            width: 100%; /* Allow it to take full width */
            max-width: 400px; /* Max width for larger screens */
            height: auto; /* Allow height to adjust based on card height */
            gap: 8px;
            padding: 8px;
            margin: 15px auto;
            justify-content: center;
        }

        .game-board-shell.three-cards .card-shell {
            flex: 1 1 auto; /* Allow cards to grow and shrink */
            max-width: 120px; /* Max width for individual cards */
            height: 160px; /* Fixed height for rectangular shape (120 * 4/3) */
            min-width: 80px; /* Minimum width for very small screens */
        }

        /* Media queries for iPhone SE and similar devices */
        @media (max-width: 375px) {
            .game-board-shell.three-cards {
                gap: 4px;
                padding: 4px;
            }

            .game-board-shell.three-cards .card-shell {
                max-width: 100px; /* Slightly smaller max-width for 375px screens */
                height: 133px; /* Maintain aspect ratio (100 * 4/3) */
                min-width: 80px; /* Adjust min-width for 375px screens */
            }
            
            .game-title-main {
                font-size: 1.4rem;
                margin-bottom: 10px;
            }

            .game-desc {
                font-size: 0.8rem;
                padding: 0 10px;
                margin-bottom: 12px;
            }

            #num-cards-selection {
                margin-bottom: 8px;
                gap: 12px;
            }
        }

        /* Adjust card borders for better visibility */
        .game-board-shell.three-cards .card-shell-inner {
            border: 3px solid var(--mc-yellow);
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        /* Game section wrapper styles */        #outerGameSection {
            width: 100%;
            display: flex;
            justify-content: center;
            position: relative;
            z-index: 10;
            height: auto;
            min-height: 200px; /* Add minimum height to prevent layout shifts */
            margin-bottom: 30px; /* Add space after the game board */
        }

        #innerGameSection {
            width: 100%;
            position: relative;
            z-index: 1;
            display: flex;
            justify-content: center;
            align-items: flex-start; /* Change to flex-start to prevent vertical centering */
        }

        .card-shell {
            position: relative;
            z-index: 15;
            width: 140px; 
            height: 140px; 
            perspective: 1000px;
            cursor: pointer;
            transition: transform 0.6s, top 0.5s ease-in-out, left 0.5s ease-in-out, opacity 0.3s;
            margin-left: auto;
            margin-right: auto;
        }

        /* Ensure elements maintain proper z-index hierarchy */
        body {
            position: relative;
            z-index: 1;
        }

        .menus-wrapper, #game-interaction-area {
            position: relative;
            z-index: 20;
        }

        #outerGameSection {
            position: relative;
            z-index: 10;
        }        a.home-button {
            position: relative;
            z-index: 1000; /* Always on top */
            display: inline-block;
            margin-top: 10px;
            padding: 7px 14px; /* 30% smaller */
            background-color: #e74c3c;
            color: white;
            text-decoration: none;
            border-radius: 14px; /* 30% smaller */
            font-size: 0.7rem; /* 30% smaller */
            font-weight: 500;
            box-shadow: 0 2.1px #c0392b; /* 30% smaller */
            transition: background-color 0.2s, transform 0.1s;
        }

        /* Maintain z-index during transitions */
        .card-shell[style*="position: absolute"] {
            z-index: 15 !important;
        }

        .card-shell-inner {
            position: relative;
            width: 100%;
            height: 100%;
            text-align: center;
            transition: transform 0.5s ease-in-out;
            transform-style: preserve-3d;
            border: 3px solid var(--mc-yellow);
            border-radius: 10px;
            background-color: rgba(255, 255, 255, 0.1);
            z-index: 15;
        }

        .card-shell.flipped .card-shell-inner { transform: rotateY(180deg); }
        .card-shell.target-revealed .card-shell-inner { transform: rotateY(0deg); }
        .card-shell.incorrect-revealed .card-shell-inner { transform: rotateY(0deg); animation: shake 0.5s; }

        .card-shell-face {
            position: absolute; width: 100%; height: 100%; border-radius: 7px;
            display: flex; align-items: center; justify-content: center; padding: 0px;
            backface-visibility: hidden; -webkit-backface-visibility: hidden;
        }
        /* Front face of card */
        .card-shell-front {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .card-shell-back { 
            background-color: var(--mc-blue);
            transform: rotateY(180deg);
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><text x="50%" y="55%" dominant-baseline="middle" text-anchor="middle" font-size="70" fill="rgba(255,255,255,0.8)" style="filter: drop-shadow(1px 1px 1px rgba(0,0,0,0.4));">?</text></svg>');
            background-size: 60%;
            background-repeat: no-repeat;
            background-position: center;
        }
        .card-svg { width: 90%; height: 90%; object-fit: contain; }
        .bg-purple { background-color: var(--card-purple); } 
        .bg-blue { background-color: var(--card-blue); }

        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: rgba(0,0,0,0.7); display: none;
            justify-content: center; align-items: center; z-index: 1000;
            opacity: 0; transition: opacity 0.3s ease-in-out;
        }
        .modal-overlay.show { display: flex; opacity: 1; }
        .modal-content {
            background: linear-gradient(135deg, #2ecc71, #27ae60);
            padding: 2rem 3rem; border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3); text-align: center;
            transform: scale(0.7); transition: transform 0.3s ease-in-out;
        }
        .modal-overlay.show .modal-content { transform: scale(1); }
        .modal-content h2 { color: white; font-size: 2rem; margin: 0; text-shadow: 2px 2px 4px rgba(0,0,0,0.2); }        a.home-button {
            display: inline-block; 
            margin-top: 10px; 
            padding: 10px 20px;
            background-color: #e74c3c; 
            color: white; 
            text-decoration: none;
            border-radius: 20px; 
            font-size: 1rem; 
            font-weight: 500;
            box-shadow: 0 3px #c0392b;
            position: relative;
            z-index: 100;
        }
        a.home-button:active { 
            transform: translateY(1px); 
            box-shadow: 0 2px #c0392b; 
        }
        a.home-button:hover {
            background-color: #d62c1a;
        }

         
        /* Custom checkbox style for Number of Cards */
        .num-cards-checkbox {
            position: relative;
            padding-left: 30px;
            cursor: pointer;
            font-size: 1.05em;
            color: #f0e68c;
            user-select: none;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        .num-cards-checkbox input[type="radio"] {
            opacity: 0;
            position: absolute;
            left: 0;
            top: 0;
            width: 22px;
            height: 22px;
            margin: 0;
            z-index: 2;
            cursor: pointer;
        }
        .custom-checkbox {
            position: absolute;
            left: 0;
            top: 0;
            width: 22px;
            height: 22px;
            background: #222e3a;
            border: 2px solid var(--mc-yellow);
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: border-color 0.2s;
        }
        .num-cards-checkbox input[type="radio"]:checked ~ .custom-checkbox {
            background: var(--mc-yellow);
            border-color: var(--mc-yellow);
        }
        .custom-checkbox:after {
            content: '';
            display: none;
            width: 10px;
            height: 10px;
            border-radius: 2px;
            border: solid #222e3a;
            border-width: 0 0.18em 0.18em 0;
            transform: rotate(45deg);
            margin-left: 5px;
            margin-top: 1px;
        }
        .num-cards-checkbox input[type="radio"]:checked ~ .custom-checkbox:after {
            display: block;
            content: '';
            width: 8px;
            height: 14px;
            border: solid #222e3a;
            border-width: 0 3px 3px 0;
            transform: rotate(45deg);
            margin-left: 6px;
            margin-top: -2px;
        }
        
         /* --- Firework Animation --- */
        .firework {
            position: fixed;
            left: 0; top: 0; width: 100vw; height: 100vh;
            pointer-events: none;
            z-index: 2000;
        }
        .firework > .before, .firework > .after {
            position: absolute;
            width: 5px;
            height: 5px;
            border-radius: 50%;
            content: '';
            box-shadow: 0 0 #fff, 0 0 #fff, 0 0 #fff, 0 0 #fff, 0 0 #fff, 0 0 #fff, 0 0 #fff, 0 0 #fff, 0 0 #fff, 0 0 #fff, 0 0 #fff, 0 0 #fff, 0 0 #fff, 0 0 #fff, 0 0 #fff, 0 0 #fff, 0 0 #fff, 0 0 #fff, 0 0 #fff, 0 0 #fff, 0 0 #fff, 0 0 #fff, 0 0 #fff, 0 0 #fff, 0 0 #fff, 0 0 #fff, 0 0 #fff, 0 0 #fff, 0 0 #fff, 0 0 #fff, 0 0 #fff, 0 0 #fff;
            animation: bang 1s ease-out forwards, gravity 1s ease-in forwards, position 5s linear forwards;
        }
        .firework > .after {
            animation-delay: 1.25s, 1.25s, 1.25s;
            animation-duration: 1.25s, 1.25s, 6.25s;
        }
        @keyframes bang {
            to {
                box-shadow:
                    0 0 #fff,
                    50px -80px hsl(0,100%,50%),
                    -60px -60px hsl(30,100%,50%),
                    80px 0 hsl(60,100%,50%),
                    -80px 0 hsl(90,100%,50%),
                    60px 60px hsl(120,100%,50%),
                    -50px 80px hsl(150,100%,50%),
                    0 90px hsl(180,100%,50%),
                    0 -90px hsl(210,100%,50%),
                    90px 0 hsl(240,100%,50%),
                    -90px 0 hsl(270,100%,50%),
                    70px 70px hsl(300,100%,50%),
                    -70px 70px hsl(330,100%,50%),
                    30px -100px hsl(45,100%,50%),
                    -30px -100px hsl(75,100%,50%),
                    100px 30px hsl(105,100%,50%),
                    -100px 30px hsl(135,100%,50%),
                    100px -30px hsl(165,100%,50%),
                    -100px -30px hsl(195,100%,50%),
                    30px 100px hsl(225,100%,50%),
                    -30px 100px hsl(255,100%,50%),
                    60px -90px hsl(285,100%,50%),
                    -60px -90px hsl(315,100%,50%),
                    90px 60px hsl(345,100%,50%),
                    -90px 60px hsl(15,100%,50%),
                    0 0 #fff;
            }
        }
        @keyframes gravity {
            to {
                transform: translateY(200px);
                opacity: 0;
            }
        }
        @keyframes position {
            0%, 19.9% {
                margin-top: 10%;
                margin-left: 40%;
            }
            20%, 39.9% {
                margin-top: 40%;
                margin-left: 30%;
            }
            40%, 59.9% {
                margin-top: 20%;
                margin-left: 70%;
            }
            60%, 79.9% {
                margin-top: 30%;
                margin-left: 20%;
            }
            80%, 99.9% {
                margin-top: 30%;
                margin-left: 80%;
            }
        }

        @keyframes pulse-mc {
            0%, 100% { box-shadow: 0 0 8px var(--mc-orange), 0 0 15px var(--mc-orange); transform: scale(1); }
            50% { box-shadow: 0 0 15px var(--mc-orange), 0 0 25px var(--mc-orange); transform: scale(1.03); }
        }
        .highlight-mc-target .card-shell-inner { animation: pulse-mc 1s infinite alternate; }
        @keyframes shake {
            0%, 100% { transform: translateX(0) rotateY(0deg); }
            25% { transform: translateX(-5px) rotateY(0deg); }
            50% { transform: translateX(5px) rotateY(0deg); }
            75% { transform: translateX(-5px) rotateY(0deg); }
        }        /* Responsive adjustments for shell game board */        @media (min-width: 380px) {
            .game-board-shell { 
                width: 330px; 
                height: 330px; 
            }
            .game-board-shell.three-cards {
                height: 180px;
            }
            .card-shell { 
                width: 160px; 
                height: 160px; 
            }
            .game-board-shell.six-cards { 
                width: 330px;
                height: 240px;
            }
            .game-board-shell.six-cards .card-shell {
                width: 105px;
                height: 105px;
            }
        }
        @media (min-width: 640px) {
            .game-board-shell { 
                width: 440px; 
                height: 440px; 
            }
            .game-board-shell.three-cards {
                height: 200px;
            }
            .card-shell { 
                width: 200px; 
                height: 200px; 
            }
            .game-board-shell.six-cards { 
                width: 440px;
                height: 300px;
            }
            .game-board-shell.six-cards .card-shell {
                width: 140px;
                height: 140px;
            }
        }

        #innerGameSection {  
            width: 100%;
            position: relative;
        }

        #outerGameSection {
            width:100%;
            display: flex;
            justify-content: center;
        }

        #innerGameSection .game-board-shell {
            justify-content: center;
        }

        /* Front face of card */
        .card-shell-front {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        
    </style>
    <link rel="icon" href="favicon.ico" type="image/x-icon">
</head>
<body>    
    <h1 class="game-title-main">Three (4 & 6) Card Monte</h1>
    <h2 class="game-desc" style="max-width: 500px; margin: 0 auto 18px auto; color: #f0e68c; font-size: .9rem; text-align: center;">
        Test your brain with this fun memory challenge! Play the classic Three Card Monte game online for free, featuring 3, 4, or 6 cards. Watch closely as the cards shuffle, then find the hidden pet‚Äîno downloads or sign-ups required.
    </h2>
    
    </div>        <div id="num-cards-selection" style="margin-bottom: 10px; display: flex; align-items: center; gap: 18px;">
            <span style="font-weight:600; color:#f0e68c;">Number of Cards:</span>
            <label class="num-cards-checkbox">
                <input type="radio" name="numCards" value="3">
                <span class="custom-checkbox"></span>
                3
            </label>
            <label class="num-cards-checkbox">
                <input type="radio" name="numCards" value="4" checked>
                <span class="custom-checkbox"></span>
                4
            </label>
            <label class="num-cards-checkbox">
                <input type="radio" name="numCards" value="6">
                <span class="custom-checkbox"></span>
                6
            </label>
        </div>
        
    
    <div class="menus-wrapper">
        <div class="menu-container level-menu-container">
            <h2 class="menu-title">Select Difficulty:</h2>
            <div class="level-menu" id="levelMenuContainer"></div>
        </div>
    </div>


    <div id="game-interaction-area">
        
        <div id="message-area">Select difficulty and click Start!</div>
        <div id="action-button-container">
            <button id="actionButton">Start Game</button>
        </div>
    </div>

    <div id="outerGameSection">
        <div id="innerGameSection">
            <div id="gameBoardShell" class="game-board-shell"></div>
        </div>
    </div>
    

    <div id="winModalOverlay" class="modal-overlay">
        <div class="modal-content">
            <h2 id="winModalMessage">You found it!</h2>
        </div>
    </div>
    
     
    <a href="index.html" class="home-button">
        üè† Back to Main Menu
    </a>
     
    

    <script>        // Initialize game variables
        const gameBoard = document.getElementById('gameBoardShell');
        const levelMenuContainer = document.getElementById('levelMenuContainer');
        const actionButton = document.getElementById('actionButton');
        const messageArea = document.getElementById('message-area');
        const winModalOverlay = document.getElementById('winModalOverlay');
        const winModalMessage = document.getElementById('winModalMessage');
        let cardsOnBoard = [];
        let targetPet = null;
        let canClickCard = false;
        let gameActive = false;

        // Initialize menu button reference
        const menuButton = document.querySelector('a.home-button');

        function hideMenuButton() {
            if (menuButton) {
                menuButton.style.visibility = 'hidden';
            }
        }

        function showMenuButton() {
            if (menuButton) {
                menuButton.style.visibility = 'visible';
            }
        }

        // Function to get selected number of cards
        function getSelectedNumCards() {
            const selected = document.querySelector('input[name="numCards"]:checked');
            return selected ? parseInt(selected.value, 10) : 4;
        }

        // Initialize game state
        let currentLevelKey = 'easy';
        let currentDifficulty = getLevelsByNumCards(getSelectedNumCards())[currentLevelKey];

        // Add event listeners for number of cards selection          
        document.querySelectorAll('input[name="numCards"]').forEach(radio => {
            radio.addEventListener('change', () => {
                // Reset any ongoing animations
                if (cardsOnBoard) {
                    cardsOnBoard.forEach(card => {
                        card.style.position = '';
                        card.style.left = '';
                        card.style.top = '';
                        card.style.margin = '';
                        card.style.transition = '';
                        card.style.zIndex = '';
                    });
                }
                // Reset game board height
                gameBoard.style.height = '';
                
                const numCards = parseInt(radio.value, 10);
                currentDifficulty = getLevelsByNumCards(numCards)[currentLevelKey];
                gameActive = false; // Ensure game is stopped
                canClickCard = false; // Reset click state
                updateGameBoardClass();
                createLevelButtons();
                resetGameUI('Start Game');
                setupBoard_for_Init();
                actionButton.disabled = false; // Enable the Start Game button
            });
        });

        // Function to update game board class based on number of cards
        function updateGameBoardClass() {
            const numCards = getSelectedNumCards();
            gameBoard.classList.remove('three-cards', 'four-cards', 'six-cards');
            if (numCards === 3) {
                gameBoard.classList.add('three-cards');
            } else if (numCards === 4) {
                gameBoard.classList.add('four-cards');
            } else if (numCards === 6) {
                gameBoard.classList.add('six-cards');
            }
        }

        // Initialize the game board class on page load
        updateGameBoardClass();

        // --- GAME LOGIC REPLACEMENT START ---
        const petDefinitions = [
            { id: 'bird', name: 'Bird', imageSrc: 'memory-game-assets/pets/bird.jpg' },
            { id: 'bunny', name: 'Bunny', imageSrc: 'memory-game-assets/pets/bunny.jpg' },
            { id: 'cat', name: 'Cat', imageSrc: 'memory-game-assets/pets/cat.jpg' },
            { id: 'dog', name: 'Dog', imageSrc: 'memory-game-assets/pets/dog.jpg' },
            { id: 'ferret', name: 'Ferret', imageSrc: 'memory-game-assets/pets/ferret.jpg' },                                                                                                                                                                                                                                                                                                                                     
            { id: 'fish', name: 'Fish', imageSrc: 'memory-game-assets/pets/fish.jpg' },
            { id: 'guinea-pig', name: 'Guinea Pig', imageSrc: 'memory-game-assets/pets/guinea-pig.jpg' },
            { id: 'hamster', name: 'Hamster', imageSrc: 'memory-game-assets/pets/hamster.jpg' },
            { id: 'lizard', name: 'Lizard', imageSrc: 'memory-game-assets/pets/lizard.jpg' },
            { id: 'mouse', name: 'Mouse', imageSrc: 'memory-game-assets/pets/mouse.jpg' },
            { id: 'parrot', name: 'Parrot', imageSrc: 'memory-game-assets/pets/parrot.jpg' },
            { id: 'turtle', name: 'Turtle', imageSrc: 'memory-game-assets/pets/turtle.jpg' }
        ];

        // LEVELS now depend on number of cards selected        
        function getLevelsByNumCards(numCards) {
            if (numCards === 3) {
                return {
                    easy:   { name: 'Easy', rows: 1, cols: 3, shuffles: 5, shuffleSpeed: 500 },
                    medium: { name: 'Medium', rows: 1, cols: 3, shuffles: 10, shuffleSpeed: 300 },
                    hard:   { name: 'Hard', rows: 1, cols: 3, shuffles: 20, shuffleSpeed: 167 }
                };
            } else if (numCards === 4) {
                return {
                    easy:   { name: 'Easy', rows: 2, cols: 2, shuffles: 7, shuffleSpeed: 500 },
                    medium: { name: 'Medium', rows: 2, cols: 2, shuffles: 15, shuffleSpeed: 300 },
                    hard:   { name: 'Hard', rows: 2, cols: 2, shuffles: 25, shuffleSpeed: 167 }
                };
            } else if (numCards === 6) {
                return {
                    easy:   { name: 'Easy', rows: 2, cols: 3, shuffles: 10, shuffleSpeed: 500 },
                    medium: { name: 'Medium', rows: 2, cols: 3, shuffles: 18, shuffleSpeed: 300 },
                    hard:   { name: 'Hard', rows: 2, cols: 3, shuffles: 30, shuffleSpeed: 167 }
                };
            } else {
                // fallback for other numbers
                return {
                    easy:   { name: 'Easy', rows: 2, cols: Math.ceil(numCards/2), shuffles: 10, shuffleSpeed: 500 },
                    medium: { name: 'Medium', rows: 2, cols: Math.ceil(numCards/2), shuffles: 18, shuffleSpeed: 300 },
                    hard:   { name: 'Hard', rows: 2, cols: Math.ceil(numCards/2), shuffles: 30, shuffleSpeed: 167 }
                };
            }
        }        // Game state will be initialized during setup

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function createLevelButtons() {
            // Clear previous buttons
            levelMenuContainer.innerHTML = '';
            var numCards = getSelectedNumCards ? getSelectedNumCards() : 4;
            var LEVELS = getLevelsByNumCards(numCards);
            Object.keys(LEVELS).forEach(key => {
                const level = LEVELS[key];
                const button = document.createElement('button');
                button.id = `level-${key}-button`;
                button.classList.add('menu-button');
                if (key === currentLevelKey) button.classList.add('active');
                button.textContent = level.name;
                button.addEventListener('click', () => selectLevel(key));
                levelMenuContainer.appendChild(button);
            });
        }

        function selectLevel(levelKey) {
            if (gameActive) return;
            currentLevelKey = levelKey;
            var numCards = getSelectedNumCards ? getSelectedNumCards() : 4;
            var LEVELS = getLevelsByNumCards(numCards);
            currentDifficulty = LEVELS[currentLevelKey];
            Array.from(levelMenuContainer.children).forEach(btn => {
                btn.classList.toggle('active', btn.id === `level-${levelKey}-button`);
            });
            resetGameUI();
        }

        function createCardElement(pet, id) {
            const card = document.createElement('div');
            card.className = 'card-shell';
            card.dataset.id = pet.id;
            card.dataset.name = pet.name;
            card.dataset.index = id;

            const cardInner = document.createElement('div');
            cardInner.className = 'card-shell-inner';            const cardFront = document.createElement('div');
            cardFront.className = 'card-shell-face card-shell-front bg-blue';
            const img = document.createElement('img');
            img.src = pet.imageSrc;
            img.alt = pet.name;
            img.className = 'card-svg';
            cardFront.appendChild(img);

            const cardBack = document.createElement('div');
            cardBack.className = 'card-shell-face card-shell-back';

            cardInner.appendChild(cardFront);
            cardInner.appendChild(cardBack);
            card.appendChild(cardInner);

            card.addEventListener('click', () => handleCardClick(card));
            return card;
        }

        // Function to get selected number of cards
        function getSelectedNumCards() {
            const selected = document.querySelector('input[name="numCards"]:checked');
            return selected ? parseInt(selected.value, 10) : 4;
        }

        function setupGameGrid() {
            const numCards = getSelectedNumCards();
            let cols, rows;
            
            // Set grid configuration based on number of cards
            if (numCards === 3) {
                cols = 3;
                rows = 1;
            } else if (numCards === 4) {
                cols = 2;
                rows = 2;
            } else if (numCards === 6) {
                cols = 3;
                rows = 2;
            } else {
                cols = Math.ceil(Math.sqrt(numCards));
                rows = Math.ceil(numCards / cols);
            }

            // Update game board styles based on number of cards
            updateGameBoardClass();

            return { cols, rows };
        }

        function setupBoard() {
            messageArea.textContent = "Getting ready...";
            actionButton.disabled = true;
            gameBoard.innerHTML = '';
            cardsOnBoard = [];

            const numCards = getSelectedNumCards();
            const { cols, rows } = setupGameGrid();
            const availablePets = shuffleArray([...petDefinitions]);
            const petsForGame = availablePets.slice(0, numCards);
            targetPet = petsForGame[Math.floor(Math.random() * petsForGame.length)];

            gameBoard.style.gridTemplateColumns = `repeat(${cols}, 1fr)`;
            gameBoard.style.gridTemplateRows = `repeat(${rows}, 1fr)`;

            petsForGame.forEach((pet, idx) => {
                const card = createCardElement(pet, idx);
                cardsOnBoard.push(card);
                gameBoard.appendChild(card);
            });
            
            cardsOnBoard.forEach(card => card.classList.remove('flipped'));
            setTimeout(() => highlightTargetCard(), 1200);
        }

        function setupBoard_for_Init() {
            const numCards = getSelectedNumCards();
            const { cols, rows } = setupGameGrid();
            
            messageArea.textContent = "Getting ready...";
            actionButton.disabled = true;
            gameBoard.innerHTML = '';
            cardsOnBoard = [];

            const availablePets = shuffleArray([...petDefinitions]);
            const petsForGame = availablePets.slice(0, numCards);
            targetPet = petsForGame[Math.floor(Math.random() * petsForGame.length)];

            gameBoard.style.gridTemplateColumns = `repeat(${cols}, 1fr)`;
            gameBoard.style.gridTemplateRows = `repeat(${rows}, 1fr)`;

            petsForGame.forEach((pet, idx) => {
                const card = createCardElement(pet, idx);
                cardsOnBoard.push(card);
                gameBoard.appendChild(card);
            });

            cardsOnBoard.forEach(card => card.classList.add('flipped'));
        }

        function highlightTargetCard() {
            messageArea.textContent = `Find the ${targetPet.name}!`;
            const targetCard = cardsOnBoard.find(card => card.dataset.id === targetPet.id);
            if (targetCard) {
                
                targetCard.classList.add('highlight-mc-target');
            }
            setTimeout(() => {
                if (targetCard) {
                    targetCard.classList.remove('highlight-mc-target');
                }
                flipAllToBackAndPrepareShuffle();
            }, 2000);
        }

        function flipAllToBackAndPrepareShuffle() {
            messageArea.textContent = 'Watch closely...';
            cardsOnBoard.forEach(card => card.classList.add('flipped'));
            setTimeout(() => startShuffleAnimation(), 1000);
        }

        async function startShuffleAnimation() {            messageArea.textContent = 'Shuffling!';
            gameBoard.style.height = `${gameBoard.offsetHeight}px`; // Fix the height
            let cardPositions = cardsOnBoard.map(card => {
                const rect = card.getBoundingClientRect();
                const computedStyle = window.getComputedStyle(card);
                return {
                    left: rect.left,
                    top: rect.top,
                    marginLeft: computedStyle.marginLeft,
                    marginRight: computedStyle.marginRight
                };
            });
            let boardRect = gameBoard.getBoundingClientRect();
            // Set absolute positions for animation
            cardsOnBoard.forEach((card, idx) => {
                card.style.position = 'absolute';
                card.style.margin = '0';
                card.style.left = `${cardPositions[idx].left - boardRect.left}px`;
                card.style.top = `${cardPositions[idx].top - boardRect.top}px`;
                card.style.transition = 'left 0.5s, top 0.5s';
            });
            await new Promise(r => setTimeout(r, 50));
            for (let i = 0; i < currentDifficulty.shuffles; i++) {
                let idx1 = Math.floor(Math.random() * cardsOnBoard.length);
                let idx2 = Math.floor(Math.random() * cardsOnBoard.length);
                while (idx1 === idx2) idx2 = Math.floor(Math.random() * cardsOnBoard.length);
                // Swap positions
                let tempLeft = cardsOnBoard[idx1].style.left;
                let tempTop = cardsOnBoard[idx1].style.top;
                cardsOnBoard[idx1].style.left = cardsOnBoard[idx2].style.left;
                cardsOnBoard[idx1].style.top = cardsOnBoard[idx2].style.top;
                cardsOnBoard[idx2].style.left = tempLeft;
                cardsOnBoard[idx2].style.top = tempTop;
                [cardsOnBoard[idx1], cardsOnBoard[idx2]] = [cardsOnBoard[idx2], cardsOnBoard[idx1]];
                await new Promise(r => setTimeout(r, currentDifficulty.shuffleSpeed));
            }
            // Reset to grid
            gameBoard.innerHTML = '';
            cardsOnBoard.forEach(card => {
                card.style.position = '';
                card.style.left = '';
                card.style.top = '';
                card.style.transition = '';
                gameBoard.appendChild(card);
            });
            canClickCard = true;
            messageArea.textContent = `Where is the ${targetPet.name}? Click a card!`;
        }

        function handleCardClick(card) {
            if (!canClickCard) return;
            canClickCard = false;
            card.classList.remove('flipped');
            if (card.dataset.id === targetPet.id) {
                card.classList.add('target-revealed');
                messageArea.textContent = `Yeah! You found the ${targetPet.name}!`;
                winModalMessage.textContent = `You found the ${targetPet.name}!`;
                // Firework animation
                const fireworks = [];
                for (let i = 0; i < 3; i++) {
                    const firework = document.createElement('div');
                    firework.className = 'firework';
                    firework.innerHTML = '<div class="before"></div><div class="after"></div>';
                    firework.style.animationDelay = `${i * 0.2}s`;
                    document.body.appendChild(firework);
                    fireworks.push(firework);
                }
                winModalOverlay.classList.add('show');
                setTimeout(() => {
                    winModalOverlay.classList.remove('show');
                    fireworks.forEach(fw => { if (fw.parentNode) fw.parentNode.removeChild(fw); });
                    resetGameUI('Play Again?');
                }, 2500);
            } else {
                card.classList.add('incorrect-revealed');
                messageArea.textContent = `Oops! That's not the ${targetPet.name}.`;
                setTimeout(() => {
                    const correctCard = cardsOnBoard.find(c => c.dataset.id === targetPet.id && c !== card);
                    if (correctCard) {
                        correctCard.classList.remove('flipped');
                        correctCard.classList.add('target-revealed', 'highlight-mc-target');
                    }
                    setTimeout(() => {
                        if (correctCard) {
                            correctCard.classList.remove('highlight-mc-target');
                            if(card.dataset.id !== targetPet.id) {
                                correctCard.classList.add('flipped');
                                correctCard.classList.remove('target-revealed');
                            }
                        }
                        card.classList.add('flipped');
                        card.classList.remove('incorrect-revealed');
                        resetGameUI('Try Again?');
                    }, 2000);
                }, 1500);
            }
        }        function resetGameUI(buttonText = "Start Game") {
            gameActive = false;
            canClickCard = false;
            actionButton.textContent = buttonText;
            
            // Always enable the button when resetting UI with these messages
            if (buttonText === "Start Game" || buttonText === "Play Again?" || buttonText === "Try Again?") {
                messageArea.textContent = buttonText === "Try Again?" ? "Give it another go!" : "Select difficulty and click Start!";
                actionButton.disabled = false;
            }
        }

        actionButton.addEventListener('click', () => {
            if (actionButton.textContent === "Start Game" || actionButton.textContent === "Play Again?" || actionButton.textContent === "Try Again?") {
                gameActive = true;
                setupBoard();
            }
        });        createLevelButtons();
        setupBoard_for_Init();
        // Initialize button state after setup
        actionButton.disabled = false;
        messageArea.textContent = "Select difficulty and click Start!";

        function updateGameBoardClass() {
            const numCards = getSelectedNumCards();
            gameBoard.classList.remove('three-cards', 'four-cards', 'six-cards');
            if (numCards === 3) {
                gameBoard.classList.add('three-cards');
            } else if (numCards === 4) {
                gameBoard.classList.add('four-cards');
            } else if (numCards === 6) {
                gameBoard.classList.add('six-cards');
            }
        }

        // Initialize the game board class on page load
        updateGameBoardClass();

        // --- GAME LOGIC REPLACEMENT END ---
    </script>
    
</body>
</html>
